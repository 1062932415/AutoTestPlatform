<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Voice Test</title>
    <script src="../lib/jquery-2.1.1.min.js"></script>
    <link rel="stylesheet" href="../lib/bootstrap.min.css" />
    <link rel="stylesheet" href="../styles/SimpleCalculadorajQuery.css" />
</head>
<body class="container-fluid">
<audio src="../data/voice/1.WAV" id="voice_1"></audio>
<audio src="../data/voice/2.WAV" id="voice_2"></audio>
<audio src="../data/voice/3.WAV" id="voice_3"></audio>
<audio src="../data/voice/4.WAV" id="voice_4"></audio>
<audio src="../data/voice/5.WAV" id="voice_5"></audio>
<audio src="../data/voice/6.WAV" id="voice_6"></audio>
<audio src="../data/voice/7.WAV" id="voice_7"></audio>
<audio src="../data/voice/8.WAV" id="voice_8"></audio>
<audio src="../data/voice/9.WAV" id="voice_9"></audio>
<audio src="../data/voice/0.WAV" id="voice_0"></audio>
<div id="idCalculadora">
    <div class="panel panel-primary btn-block calculadoraBase  mtop">
        <div class="panel-body">
            <div class="col-md-12" style="margin-bottom: 10px;">
                <input type="text" class="form-control txtr" id="idCalculadoratxtResultado" value="">
                <div class="row" id="idCalculadorabtns">
                    <div class="col-md-4 col-xs-4 mbottom">
                        <input type="button" class="idCalculadoratcl btn3d btn-lg btn-block btn btn-primary"  value="7">
                    </div>
                    <div class="col-md-4 col-xs-4 mbottom">
                        <input type="button" class="idCalculadoratcl btn3d btn-lg btn-block btn btn-primary" value="8">
                    </div>
                    <div class="col-md-4 col-xs-4 mbottom">
                        <input type="button" class="idCalculadoratcl btn3d btn-lg btn-block btn btn-primary" value="9">
                    </div>
                    <div class="col-md-4 col-xs-4 mbottom">
                        <input type="button" class="idCalculadoratcl btn3d btn-lg btn-block btn btn-primary" value="4">
                    </div>
                    <div class="col-md-4 col-xs-4 mbottom">
                        <input type="button" class="idCalculadoratcl btn3d btn-lg btn-block btn btn-primary" value="5">
                    </div>
                    <div class="col-md-4 col-xs-4 mbottom">
                        <input type="button" class="idCalculadoratcl btn3d btn-lg btn-block btn btn-primary" value="6">
                    </div>
                    <div class="col-md-4 col-xs-4 mbottom">
                        <input type="button" class="idCalculadoratcl btn3d btn-lg btn-block btn btn-primary" value="1">
                    </div>
                    <div class="col-md-4 col-xs-4 mbottom">
                        <input type="button" class="idCalculadoratcl btn3d btn-lg btn-block btn btn-primary" value="2">
                    </div>
                    <div class="col-md-4 col-xs-4 mbottom">
                        <input type="button" class="idCalculadoratcl btn3d btn-lg btn-block btn btn-primary" value="3">
                    </div>
                    <div class="col-md-4 col-xs-4 mbottom">
                        <input type="button" class="idCalculadoratcl btn3d btn-lg btn-block btn btn-warning" id="btnMinuse" value="<">
                    </div>
                    <div class="col-md-4 col-xs-4 mbottom">
                        <input type="button" class="idCalculadoratcl btn3d btn-lg btn-block btn btn-primary" value="0">
                    </div>
                    <div class="col-md-4 col-xs-4 mbottom">
                        <input type="button" class="idCalculadoratcl btn3d btn-lg btn-block btn btn-danger" id="btnClear" value="清除">
                    </div>
                </div>
                <input type="button" id="idCalculadoraBorrar" class="btn3d btn btn-success btn-lg btn-block"
                       value="朗读"></div>
        </div>
    </div>
</div>
<!--<input type="button" value="play" id="play" />-->
<script>
    $(document).ready(function () {
        var screen = $("#idCalculadoratxtResultado");
        var arrReading = [];
        var current = 0;
        var isReading = false;
        var g = function (str) {
            return document.querySelector(str);
        };

        $("#idCalculadorabtns .btn-primary").click(function () {
            if(isReading){
                return;
            }
            arrReading.push($(this).val());
            screen.val(screen.val() + $(this).val());
        });

        $("#btnClear").click(function () {
            if(isReading){
                return;
            }
            screen.val("");
            arrReading = [];
        });

        $("#btnMinuse").click(function () {
            if(isReading){
                return;
            }
            var temp = screen.val();
            screen.val(temp.substr(0, temp.length - 1));
            arrReading.pop();
        });


        var next = function () {
            if(current < arrReading.length -1){
                current++;
                g("#voice_" + (arrReading[current])).play();
            }
            else{
                isReading = false;
            }
        };
        $("audio").on("ended", next);

        $("#idCalculadoraBorrar").click(function () {
            if(isReading){
                return;
            }
            current = 0;
            g("#voice_" + (arrReading[current])).play();
            isReading = true;
        })
    })
</script>
</body>
</html>