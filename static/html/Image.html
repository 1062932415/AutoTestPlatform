<h2 class="page-header">Image Checker</h2>
<div id="trans" class="row">
    <div class="col-md-4 navslid trans-side navslid-show">
        <div style="display:none;">
            <p>
                URL Import(.txt only)
            </p>
            <div class="input-group">
                <input class="form-control" type="file" id="file_Input">
                <span class="input-group-btn">
                <input type="button" class="btn btn-primary" value="Import" id="import_Txt"/>
            </span>
            </div>
        </div>
        <p>URL Input (US One URL only)</p>
        <p>(eg:https://www.apple.com/iphone)</p>
        <p>
            <!--<t rows="5" id="url" v-model="urls" class="form-control"></t> -->
            <input type="text" id="url" class="form-control" name="url" placeholder="Please input URL"/>
        </p>

        <button id="btn_Usquery" class="btn btn-primary">US Counts</button>
        <!--<button id="btn_Quest" class="btn btn-primary">Query</button>-->
        <button id="btn_Clear" class="btn btn-primary">Clear</button>

    </div>
    <div>
        <button class="sideIcon">&lt;</button>
    </div>
    <div class="col-md-7">
        <p class="col-md-4">
            <label>
                <input type="radio" name="optionsRadios" id="rdExcel" value="excel" checked>
                Excel
            </label>
            <label>
                <input type="radio" name="optionsRadios" id="rdHTML" value="html">
                HTML
            </label>
        </p>
        <p class="col-md-2 exbutton">
            <button id="getExcel" class="btn btn-primary">Export</button>

        </p>
        <p class="col-md-3 exbutton">
            <button id="clearres" class="btn btn-primary">Clear Result</button>

        </p>
        <table class="table table-striped table-bordered">
            <thead>
            <tr>
                <th>US Images</th>
            </tr>
            </thead>
            <tbody>
            <tr id="USres_Container"></tr>
            <tr id="USCount"></tr>
            <tr id="USImageUrl"></tr>
            </tbody>
        </table>

        <select class="sel_mask" id="geos" name="geos">
            <option value="">Please Select Geo</option>
            <option value="CN">CN</option>
            <option value="HK">HK</option>
            <option value="HKEN">HKEN</option>
            <option value="TW">TW</option>
            <option value="MO">MO</option>
            <option value="GC">GC Geos</option>
        </select>
        <button id="btn_Quest" class="btn btn-primary">Query</button>
        <button id="check" class="btn btn-primary">check</button>
        <table id="comptable" class="table table-striped table-bordered">

            <thead id="res_header">

            </thead>
            <tbody id="res_Container" class="ImageStyle">


            <!--<tr id="Count"></tr>-->

            <!--<tr id="ImageUrl"></tr>-->
            </tbody>
        </table>
    </div>
</div>

<!--<script src="../../node_modules/vue/dist/vue.js"></script>-->
<!--<script src="../../node_modules/jquery/dist/jquery.js"></script>-->
<script>

    //$('#geos option[value=""]').attr('selected', true);

    //    const url_Input = $("#urls_");
    //const res_Container = $('#res_Container');
    $("#import_Txt").click(() => {
        if ($("#file_Input")[0].files.length >= 1) {
            const file = $("#file_Input")[0].files[0];
            let reader = new FileReader();
            reader.onload = function () {
                $("#file_Input").val(this.result);
                $("#file_Input").val("");
            };
            reader.readAsText(file);
        }
    });

    $('#btn_Clear').click(() => {
        $("#url").val('');
    });
    $('#clearres').click(() => {
        $('#USres_Container').html('');
        $('#USCount').html('');
        $('#USImageUrl').html('');
    });
    $('#check').click(() => {
        alert($('#geos option:selected').val());
    });

    $('#btn_Usquery').click(() => {
        if ($("#url").val().length > 5) {
            $('#USres_Container').html('');
            $("#bg_loading").show();
            $.post('api/image/getUSImage', {url: $('#url').val()}, function (USJson_data) {
                $("#bg_loading").hide();

                if (USJson_data.result == true) {
                    let str = '';
                    let str1 = '';
                    let str2 = '';

                    console.log(USJson_data);
                    str += `<td class="text-left" style=" ">${USJson_data.data.url}</td> `;
                    str1 += `<td class="text-left" style=" ">Countï¼š${USJson_data.data.total}</td>`;
                    let ImageUrl = USJson_data.data.list;

                    ImageUrl.forEach((ImageValue, i) => {
                        str2 += `<li class="text-center">
                                       <img src="${ImageValue}" alt="ImageUrl" class="ext-thumb">
                                       <div class="ImageAddress"><a href="${ImageValue}">${ImageValue}</a></div>
                                        </li>`
                    });

                    $('#USres_Container').html(str);
                    $('#USCount').html(str1);
                    $('#USImageUrl').html(str2);
                }
            })
        } else {
            console.log("null");
        }
    });

    $('#btn_Quest').click(() => {
        if ($("#url").val().length > 5) {
            $('#res_Container').html('');
            $.post('api/image/compare', {url: $('#url').val()}, function (Json_data) {
                if (Json_data.result == true) {
                    let str = '';
                    let str0 = '';
                    let data = Json_data.data;
                    data.forEach((item, index) => {
                        let imgus = "";
                        let imgcn = "";
                        let imghktc = "";
                        let imghken = "";
                        let imgtw = "";
                        let imgmo = "";
                        if (item.US) {
                            imgus = item.US;
                        } else {
                            imgus = "No Corresponding image";
                        }
                        ;
                        if (item.CN) {
                            imgcn = item.CN;
                        } else {
                            imgcn = "No Corresponding image";
                        }
                        ;
                        if (item.HKEN) {
                            imghken = item.HKEN;
                        } else {
                            imghken = "No Corresponding image";
                        }
                        ;
                        if (item.HKTC) {
                            imghktc = item.HKTC;
                        } else {
                            imghktc = "No Corresponding image";
                        }
                        ;
                        if (item.TW) {
                            imgtw = item.TW;
                        } else {
                            imgtw = "No Corresponding image";
                        }
                        ;
                        if (item.MO) {
                            imgmo = item.MO;
                        } else {
                            imgmo = "No Corresponding image";
                        }
                        ;
                        if ($('#geos option:selected').val() == "GC") {
                            str0 = `<tr><th>Image Name</th>
                                      <th>US</th>
                                      <th>CN</th>
                                      <th>HK</th>
                                      <th>HKEN</th>
                                      <th>TW</th>
                                      <th>MO</th>
                                       </tr>`;
                            str += `<tr><td><ul><li>${item.name}</li></ul></td>
                                <td><ul><li><img class="ext-thumb" src="${imgus}" alt="${imgus}"><br>
                                      <a href="${imgus}" target="_blank">${imgus}</a></li></ul></td>
                                <td><ul><li><img class="ext-thumb" src="${imgcn}" alt="${imgcn}"><br>
                                            <a href="${imgcn}" target="_blank">${imgcn}</a><br></li></ul></td>
                                <td><ul><li><img class="ext-thumb" src="${imghken}" alt="${imghken}"><br>
                                   <a href="${imghken}" target="_blank">${imghken}</a><br></li></ul></td>
                                <td><ul><li><img class="ext-thumb" src="${imghktc}" alt="${imghktc}"><br>
                                   <a href="${imghktc}" target="_blank">${imghktc}</a><br></ul> </td>
                                <td><ul><li><img class="ext-thumb" src="${imgmo}" alt="${imgmo}"><br>
                                   <a href="${imgmo}" target="_blank">${imgmo}</a><br></ul></td>
                                <td><ul><li><img class="ext-thumb" src="${imgtw}" alt="${imgtw}"><br>
                                <a href="${imgtw}" target="_blank">${imgtw}</a><br></ul></td>
                                </tr> `
                        }
                        else if ($('#geos option:selected').val() == "CN") {
                            str0 = `<tr><th>Image Name</th>
                                      <th>US</th>
                                      <th>CN</th>
                                       </tr>`;
                            str += `<tr><td><ul><li>${item.name}</li></ul></td>
                                <td><ul><li><img class="ext-thumb" src="${imgus}" alt="${imgus}"><br>
                                      <a href="${imgus}" target="_blank">${imgus}</a></li></ul></td>
                                <td><ul><li><img class="ext-thumb" src="${imgcn}" alt="${imgcn}"><br>
                                            <a href="${imgcn}" target="_blank">${imgcn}</a><br></li></ul></td>

                                </tr> `
                        } else if ($('#geos option:selected').val() == "HKEN") {
                            str0 = `<tr><th>Image Name</th>
                                      <th>US</th>
                                      <th>HKEN</th>
                                       </tr>`;
                            str += `<tr><td><ul><li>${item.name}</li></ul></td>
                                <td><ul><li><img class="ext-thumb" src="${imgus}" alt="${imgus}"><br>
                                      <a href="${imgus}" target="_blank">${imgus}</a></li></ul></td>
                                <td><ul><li><img class="ext-thumb" src="${imghken}" alt="${imghken}"><br>
                                   <a href="${imghken}" target="_blank">${imghken}</a><br></li></ul></td>
                                </tr> `
                        } else if ($('#geos option:selected').val() == "HK") {
                            str0 = `<tr><th>Image Name</th>
                                      <th>US</th>
                                      <th>HK</th>
                                       </tr>`;
                            str += `<tr><td><ul><li>${item.name}</li></ul></td>
                                <td><ul><li><img class="ext-thumb" src="${imgus}" alt="${imgus}"><br>
                                      <a href="${imgus}" target="_blank">${imgus}</a></li></ul></td>
                                <td><ul><li><img class="ext-thumb" src="${imghktc}" alt="${imghktc}"><br>
                                   <a href="${imghktc}" target="_blank">${imghktc}</a><br></ul> </td>
                                </tr> `
                        } else if ($('#geos option:selected').val() == "TW") {
                            str0 = `<tr><th>Image Name</th>
                                      <th>US</th>
                                      <th>TW</th>
                                       </tr>`;
                            str += `<tr><td><ul><li>${item.name}</li></ul></td>
                                <td><ul><li><img class="ext-thumb" src="${imgus}" alt="${imgus}"><br>
                                      <a href="${imgus}" target="_blank">${imgus}</a></li></ul></td>
                                 <td><ul><li><img class="ext-thumb" src="${imgtw}" alt="${imgtw}"><br>
                                <a href="${imgtw}" target="_blank">${imgtw}</a><br></ul></td>
                                </tr> `
                        } else if ($('#geos option:selected').val() == "MO") {
                            str0 = `<tr><th>Image Name</th>
                                      <th>US</th>
                                      <th>MO</th>
                                       </tr>`;
                            str += `<tr><td><ul><li>${item.name}</li></ul></td>
                                <td><ul><li><img class="ext-thumb" src="${imgus}" alt="${imgus}"><br>
                                      <a href="${imgus}" target="_blank">${imgus}</a></li></ul></td>
                                 <td><ul><li><img class="ext-thumb" src="${imgmo}" alt="${imgmo}"><br>
                                   <a href="${imgmo}" target="_blank">${imgmo}</a><br></ul></td>
                                </tr> `
                        }
                    });
                    $('#res_header').html(str0);
                    $('#res_Container').html(str);


                }
            });
        } else {
            console.log("null");
        }
    });
    $("#getExcel").click(() => {
        if ($("#urls_").val().length > 0) {
            const arr = $("#res_Container").html();
            $.post('/api/trans2xls', {
                xls: JSON.stringify(arr),
                type: document.querySelector("input[name=optionsRadios]:checked").value
            }, function (data) {
                $(this).text('../data/${data}');

            })
        }

    });
    $(".sideIcon").click(() => {
        if ($(".trans-side").hasClass("navslid-hide")) {
            $(".trans-side").addClass("navslid-show");
            $(".trans-side").removeClass("navslid-hide");

        }
        else if ($(".trans-side").hasClass("navslid-show")) {
            $(".trans-side").addClass("navslid-hide");
            $(".trans-side").removeClass("navslid-show");
        }
        else {
            $(".trans-side").addClass("navslid-hide");
        }
    });
</script>