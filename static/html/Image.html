<h2 class="page-header">Image Checker</h2>
<div id="trans" class="row">
    <div class="col-md-4 navslid trans-side navslid-show">
        <div style="display:none;">
            <p>
                URL Import(.txt only)
            </p>
            <div class="input-group">
                <input class="form-control" type="file" id="file_Input">
                <span class="input-group-btn">
                <input type="button" class="btn btn-primary" value="Import" id="import_Txt"/>
            </span>
            </div>
        </div>
        <p>URL Input (One URL only)</p>
        <p>(eg:https://www.apple.com/iphone)</p>
        <p>
            <!--<t rows="5" id="url" v-model="urls" class="form-control"></t> -->
            <input type="text" id="url" name="url" placeholder="请输入" />
        </p>

        <button id="btn_Quest" class="btn btn-primary">Query</button>
        <button id="btn_Clear" class="btn btn-primary">Clear</button>
    </div>
    <div>
        <button class="sideIcon">&lt;</button>
    </div>
    <div class="col-md-7">
        <p class="col-md-4">
            <label>
                <input type="radio" name="optionsRadios" id="rdExcel" value="excel" checked>
                Excel
            </label>
            <label>
                <input type="radio" name="optionsRadios" id="rdHTML" value="html">
                HTML
            </label>
        </p>
        <p class="col-md-4 exbutton">
            <button id="getExcel" class="btn btn-primary">Export</button>
        </p>

        <table class="table table-striped table-bordered">
            <thead>
            <tr>
                <th>US</th>
                <th>CN</th>
                <th>HK</th>
                <th>HKEN</th>
                <th>TW</th>
                <th>MO</th>

            </tr>
            </thead>
            <tbody>

            <tr id="res_Container"></tr>

            <tr id="Count"></tr>
            <tr class="ImageStyle">
                <td>
                    <ul id="ImageUS"></ul>
                </td>
                <td>
                    <ul id="ImageCN"></ul>
                </td>
                <td>
                    <ul id="ImageHK"></ul>
                </td>
                <td>
                    <ul id="ImageHKEN"></ul>
                </td>
                <td>
                    <ul id="ImageTW"></ul>
                </td>
                <td>
                    <ul id="ImageMO"></ul>
                </td>
            </tr>
            <tr id="ImageUrl"></tr>
            </tbody>
        </table>
    </div>
</div>
</div>
</div>
</div>

<!--<script src="../../node_modules/vue/dist/vue.js"></script>-->
<!--<script src="../../node_modules/jquery/dist/jquery.js"></script>-->
<script>

    //$('#geos option[value=""]').attr('selected', true);

    //    const url_Input = $("#urls_");
    //const res_Container = $('#res_Container');
    $("#import_Txt").click(() => {
        if ($("#file_Input")[0].files.length >= 1) {
            const file = $("#file_Input")[0].files[0];
            let reader = new FileReader();
            reader.onload = function () {
                $("#file_Input").val(this.result);
                $("#file_Input").val("");
            };
            reader.readAsText(file);
        }
    });

    $('#btn_Clear').click(() => {
        $("#url").val('');
    });

//    [  {geo: 'us', url: 'https://ic12.apple.com/retail/business/', total: 74,
//        list: [ 'https://ic12.apple.com/v/retail/business/d/built/assets/ac-footer/buystrip/asa/icon_large.svg',
//                'https://ic12.apple.com/v/retail/business/d/built/assets/ac-footer/buystrip/asa/icon_dark_large.svg' ] },
//        {geo: '/cn/', url: 'https://ic12.apple.com/cn/retail/business/', total: 92, list:
//              [ 'https://ic12.apple.com/v/retail/business/d/built/assets/ac-footer/buystrip/asa/icon_large.svg',
//                  'https://ic12.apple.com/v/retail/business/d/built/assets/ac-footer/buystrip/asa/icon_dark_large.svg']
//        }
//    ]

    $('#btn_Quest').click(() => {
        if ($("#url").val().length > 5) {
            $('#res_Container').html('');
            $.post('/api/image', {url : $('#url').val()}, function (Json_data) {
                console.log(Json_data);
                if (Json_data.result==true) {
                    let str = '';
                    let str1='';
                    let str2='';
                    let str3='';
                    let str4='';
                    let str5='';
                    let str6='';
                    let str7='';
                    let data=Json_data.data;
                    $.each(data, function (n, value) {
                        str += `
                               <td class="text-center" style=" ">${value.url}</td>

                              `
                        str1+= `<td class="text-left" style=" ">Count：${value.total}</td>`;
                        let ImageUrl=value.list;
                        if(value.geo=='us'){
                             ImageUrl.forEach((ImageValue,i)=>{
                                str2+=`<li class="text-center">
                                       <img src="${ImageValue}" alt="ImageUrl" class="ext-thumb">
                                       <div class="ImageAddress"><a href="${ImageValue}">${ImageValue}</a></div>
                                        </li>`
                        });
                        }
                        if(value.geo=='/cn/'){
                            ImageUrl.forEach((ImageValue,i)=>{
                                //console.log(ImageValue);
                                str3+=`<li class="text-center">
                                       <img src="${ImageValue}" alt="ImageUrl" class="ext-thumb">
                                       <div class="ImageAddress"><a href="${ImageValue}">${ImageValue}</a></div>
                                        </li>`
                            });
                        }
                        if(value.geo=='/hk/'){
                            ImageUrl.forEach((ImageValue,i)=>{
                                //console.log(ImageValue);
                                str4+=`<li class="text-center">
                                       <img src="${ImageValue}" alt="ImageUrl" class="ext-thumb">
                                       <div class="ImageAddress"><a href="${ImageValue}">${ImageValue}</a></div>
                                        </li>`
                            });
                        }
                        if(value.geo=='/hk/en/'){
                            ImageUrl.forEach((ImageValue,i)=>{
                                //console.log(ImageValue);
                                str5+=`<li class="text-center">
                                       <img src="${ImageValue}" alt="ImageUrl" class="ext-thumb">
                                       <div class="ImageAddress"><a href="${ImageValue}">${ImageValue}</a></div>
                                        </li>`
                            });
                        }
                        if(value.geo=='/tw/'){
                            ImageUrl.forEach((ImageValue,i)=>{
                                //console.log(ImageValue);
                                str6+=`<li class="text-center">
                                       <img src="${ImageValue}" alt="ImageUrl" class="ext-thumb">
                                       <div class="ImageAddress"><a href="${ImageValue}">${ImageValue}</a></div>
                                        </li>`
                            });
                        }
                        if(value.geo=='/mo/'){
                            ImageUrl.forEach((ImageValue,i)=>{
                                //console.log(ImageValue);
                                str7+=`<li class="text-center">
                                       <img src="${ImageValue}" alt="ImageUrl" class="ext-thumb">
                                       <div class="ImageAddress"><a href="${ImageValue}">${ImageValue}</a></div>
                                        </li>`
                            });
                        }
                       // str3+= `<td class="text-center" style=" ">${value.list}</td>`
                    })
                    $('#res_Container').html(str);
                    $('#Count').html(str1);
                    $('#ImageUS').html(str2);
                    $('#ImageCN').html(str3);
                    $('#ImageHK').html(str4);
                    $('#ImageHKEN').html(str5);
                    $('#ImageTW').html(str6);
                    $('#ImageMO').html(str7);

                }
            });
        } else {
            console.log("null");
        }
    });
    $("#getExcel").click(() => {
        if ($("#urls_").val().length > 0) {
            const arr = $("#res_Container").html();
            $.post('/api/trans2xls', {
                xls: JSON.stringify(arr),
                type: document.querySelector("input[name=optionsRadios]:checked").value
            }, function (data) {
                $(this).text('../data/${data}');
            })
        }

    });
    $(".sideIcon").click(() => {
        if ($(".trans-side").hasClass("navslid-hide")) {
            $(".trans-side").addClass("navslid-show");
            $(".trans-side").removeClass("navslid-hide");

        }
        else if ($(".trans-side").hasClass("navslid-show")) {
            $(".trans-side").addClass("navslid-hide");
            $(".trans-side").removeClass("navslid-show");
        }
        else {
            $(".trans-side").addClass("navslid-hide");
        }
    });

    /*var app = new Vue({
     el: '#trans',
     data: {
     arr: [],
     urls: "",
     excelUrl: "",
     excelName: ""
     },
     methods: {
     quest: function () {
     if(this.urls.length > 5){
     var that = this;
     $.post('/api/wechat', {urls: this.urls}, function (data) {
     console.log(data);
     that.arr = data;
     });
     }else{
     console.log("null");
     }
     },
     getExcel: function () {
     if(this.arr.length > 0){
     var that = this;
     $.post('/api/wechat2xls', {xls: JSON.stringify(this.arr), type: document.querySelector("input[name=optionsRadios]:checked").value}, function (data) {
     console.log(data);
     that.excelName = data;
     that.excelUrl = `../data/${data}`;
     });
     }else{
     console.log('cant');
     }
     },
     importTxt: function () {
     var that = this;
     var fileInput = document.querySelector("#fileInput");
     if(fileInput.files.length >= 1){
     var file = document.querySelector("#fileInput").files[0];
     var reader = new FileReader();
     reader.onload = function () {
     console.log(this.result);
     that.urls += this.result;
     fileInput.value = "";
     };
     reader.readAsText(file);
     }
     },
     clear:function() {
     $("#urls").val('');
     }
     }
     });*/
</script>
</body>
</html>